{"ast":null,"code":"import LotTradingTime from '@/components/views/trading-session/lot/LotTradingTime';\nimport LotStatus from '@/components/views/trading-session/lot/LotStatus';\nimport LotSaleButton from '@/components/views/trading-session/lot/LotSaleButton';\nimport ShowMoreArrowIcon from '@/components/components-helpers/icons/ShowMoreArrowIcon.vue';\nimport { useUserStore } from '@/stores/user';\nimport { mapState as mapStatePinia } from 'pinia';\nexport default {\n  props: {\n    lot: Object,\n    isLotSelected: Boolean\n  },\n  data: () => ({\n    isHiddenComment: true,\n    isRegionsHidden: true\n  }),\n  computed: { ...mapStatePinia(useUserStore, ['isTrader', 'isUmiop']),\n\n    showDescriptionReceipt() {\n      if (this.lot.status.code === 'new') {\n        return false;\n      }\n\n      return true;\n    },\n\n    showLotSale() {\n      if (this.lot.status.code === 'completed' || this.lot.status.code === 'cancelled') {\n        return true;\n      }\n\n      return false;\n    },\n\n    getLotSaleWeight() {\n      if (this.lot.status.code === 'completed' || this.lot.status.code === 'cancelled') {\n        return true;\n      }\n\n      return false;\n    },\n\n    getReceipt() {\n      const res = {};\n      res.title = 'Распределено';\n\n      if (this.lot.status.code === 'completed' || this.lot.status.code === 'cancelled') {\n        res.title = 'Продано';\n      }\n\n      if (this.lot.status.code === 'receiving' || this.lot.status.code === 'waiting') {\n        res.weight = 0;\n      } else if (this.lot.status.code === 'cancelled') {\n        res.weight = 0; //todo уточнить\n\n        res.remainder = this.lot.weight - this.lot.weightSale;\n      } else if (this.lot.status.code === 'completed') {\n        res.weight = this.lot.weightSale;\n        res.remainder = this.lot.weight - this.lot.weightSale;\n      } else {\n        res.weight = this.lot.weightSale;\n      }\n\n      return res;\n    }\n\n  },\n  methods: {\n    prettify(str) {\n      try {\n        str = String(str);\n        return str.replace(/(\\d)(?=(\\d\\d\\d)+([^\\d]|$))/g, '$1 ');\n      } catch (e) {\n        console.error('Error in helpers prettify', e);\n      }\n    },\n\n    isSaleButtonClicked() {\n      return this.$store.state.lot.isSaleButtonClicked;\n    },\n\n    openLot: function () {\n      if (this.lot.status.code === 'new') {\n        this.$store.commit('lot/lotFormEdit', this.lot);\n      } else if (!this.isSaleButtonClicked()) {\n        this.$store.commit('lot/lotFormClose');\n        this.$store.commit('lot/setLot', this.lot);\n        this.$router.push('/arm_trading/lot/' + this.lot.id);\n      }\n    }\n  },\n  name: 'CalendarWeekLot',\n  components: {\n    LotStatus,\n    LotTradingTime,\n    LotSaleButton,\n    ShowMoreArrowIcon\n  }\n};","map":{"version":3,"mappings":"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","names":["LotTradingTime","LotStatus","LotSaleButton","ShowMoreArrowIcon","useUserStore","mapState","mapStatePinia","props","lot","Object","isLotSelected","Boolean","data","isHiddenComment","isRegionsHidden","computed","showDescriptionReceipt","status","code","showLotSale","getLotSaleWeight","getReceipt","res","title","weight","remainder","weightSale","methods","prettify","str","String","replace","e","console","error","isSaleButtonClicked","$store","state","openLot","commit","$router","push","id","name","components"],"sourceRoot":"","sources":["C:\\openserver\\domains\\U190001472_BitumMap_Vue\\src\\components\\views\\trading-session\\calendar\\CalendarWeekLot.vue"],"sourcesContent":["<template>\r\n  <div class=\"calendar__lot\" :class=\"{ calendar__lot_active: isLotSelected }\">\r\n    <div class=\"calendar__lot-wrap\" @click=\"openLot\">\r\n      <div class=\"calendar__lot-title\">\r\n        <div class=\"calendar__lot-title-wrapper\">\r\n          <p class=\"calendar__lot-title-id\">№{{ prettify(lot.id) }}</p>\r\n          <img class=\"calendar__lot-title-img\" src=\"@/assets/img/oil.svg\" />\r\n        </div>\r\n        <div class=\"calendar__lot-title-shipment\">\r\n          <div class=\"calendar__lot-title-shipment-text\">Отгрузка</div>\r\n          <div class=\"calendar__lot-title-shipment-date\">\r\n            {{ lot.shippingDate }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"calendar__lot-description\">\r\n        <div class=\"calendar__lot-description-name\">\r\n          {{ lot.factory.shortName }}\r\n        </div>\r\n        <div class=\"calendar__lot-description-mark\">\r\n          {{ lot.product.shortName }}\r\n        </div>\r\n        <div class=\"calendar__lot-description-create\">Выставлено</div>\r\n        <div class=\"calendar__lot-description-count-weight\">\r\n          {{ prettify(lot.weight) }} т\r\n        </div>\r\n        <div\r\n          v-if=\"showDescriptionReceipt\"\r\n          class=\"calendar__lot-description-box\"\r\n        >\r\n          <div class=\"calendar__lot-description-receipt\">\r\n            <div class=\"calendar__lot-description-receipt-title\">\r\n              {{ getReceipt.title }}\r\n            </div>\r\n            <div class=\"calendar__lot-description-receipt-count-weight\">\r\n              {{ prettify(getReceipt.weight) }} т\r\n            </div>\r\n          </div>\r\n          <div class=\"calendar__lot-description-receipt\">\r\n            <div class=\"calendar__lot-description-receipt-title\">\r\n              Участников\r\n            </div>\r\n            <div class=\"calendar__lot-description-receipt-count\">\r\n              {{ lot.uniqueCountContactor }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"showLotSale\" class=\"calendar__lot-sale\">\r\n        <div class=\"calendar__lot-sale-wrap\">\r\n          <div class=\"calendar__lot-sale-description\">\r\n            <div class=\"calendar__lot-sale-description-balance\">Остаток</div>\r\n            <div class=\"calendar__lot-sale-description-count-weight\">\r\n              {{ prettify(getReceipt.remainder) }} т\r\n            </div>\r\n          </div>\r\n          <div class=\"calendar__lot-sale-button-wrap\">\r\n            <LotSaleButton :unsoldBalance=\"getReceipt.remainder\" :lot=\"lot\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"calendar__lot-info\">\r\n        <div class=\"calendar__lot-info-title\">Торги</div>\r\n        <div class=\"calendar__lot-info-time\">\r\n          <LotTradingTime :dateStart=\"lot.dateStart\" :dateEnd=\"lot.dateEnd\" />\r\n        </div>\r\n        <LotStatus :typeStatus=\"'status'\" :status=\"lot.status\" />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- todo: переиспользовать для комментария. -->\r\n    <div class=\"calendar__lot-info-regions\">\r\n      <div\r\n        class=\"calendar__lot-info-title-region\"\r\n        :class=\"{ 'calendar__lot-info-title-region_active': !isRegionsHidden }\"\r\n        v-if=\"lot.regions\"\r\n        @click=\"isRegionsHidden = !isRegionsHidden\"\r\n      >\r\n        Регион\r\n        <ShowMoreArrowIcon class=\"calendar__lot-info-title-icon\" />\r\n      </div>\r\n\r\n      <template v-if=\"!isRegionsHidden\">\r\n        <template v-for=\"(region, index) in lot.regions\" :key=\"index\">\r\n          <div\r\n            class=\"calendar__lot-info-region\"\r\n            v-for=\"regionItem in region.regionIds\"\r\n            :key=\"regionItem.id\"\r\n          >\r\n            <span class=\"calendar__lot-info-region-name\">\r\n              {{ regionItem.name }}\r\n            </span>\r\n            <span\r\n              class=\"calendar__lot-info-region-price\"\r\n              v-if=\"region.priceMin\"\r\n            >\r\n              {{ prettify(region.priceMin) }} ₽\r\n            </span>\r\n            <!-- <span class=\"calendar__lot-info-region-price calendar__lot-info-region_no-price\" v-else>\r\n            нет цены\r\n          </span> -->\r\n          </div>\r\n        </template>\r\n      </template>\r\n    </div>\r\n\r\n    <div v-if=\"lot.comment\" class=\"calendar__lot-comment\">\r\n      <div\r\n        v-on:click=\"isHiddenComment = !isHiddenComment\"\r\n        class=\"calendar__lot-comment-item\"\r\n        :class=\"{ 'calendar__lot-comment-item_hidden': !isHiddenComment }\"\r\n      >\r\n        Комментарий\r\n      </div>\r\n      <div v-if=\"isHiddenComment === false\" class=\"calendar__lot-comment-box\">\r\n        {{ lot.comment }}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LotTradingTime from '@/components/views/trading-session/lot/LotTradingTime';\r\nimport LotStatus from '@/components/views/trading-session/lot/LotStatus';\r\nimport LotSaleButton from '@/components/views/trading-session/lot/LotSaleButton';\r\nimport ShowMoreArrowIcon from '@/components/components-helpers/icons/ShowMoreArrowIcon.vue';\r\nimport { useUserStore } from '@/stores/user';\r\nimport { mapState as mapStatePinia } from 'pinia';\r\n\r\nexport default {\r\n  props: {\r\n    lot: Object,\r\n    isLotSelected: Boolean,\r\n  },\r\n  data: () => ({\r\n    isHiddenComment: true,\r\n    isRegionsHidden: true,\r\n  }),\r\n  computed: {\r\n    ...mapStatePinia(useUserStore, ['isTrader', 'isUmiop']),\r\n    showDescriptionReceipt() {\r\n      if (this.lot.status.code === 'new') {\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    },\r\n    showLotSale() {\r\n      if (\r\n        this.lot.status.code === 'completed' ||\r\n        this.lot.status.code === 'cancelled'\r\n      ) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    },\r\n    getLotSaleWeight() {\r\n      if (\r\n        this.lot.status.code === 'completed' ||\r\n        this.lot.status.code === 'cancelled'\r\n      ) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    },\r\n    getReceipt() {\r\n      const res = {};\r\n      res.title = 'Распределено';\r\n      if (\r\n        this.lot.status.code === 'completed' ||\r\n        this.lot.status.code === 'cancelled'\r\n      ) {\r\n        res.title = 'Продано';\r\n      }\r\n\r\n      if (\r\n        this.lot.status.code === 'receiving' ||\r\n        this.lot.status.code === 'waiting'\r\n      ) {\r\n        res.weight = 0;\r\n      } else if (this.lot.status.code === 'cancelled') {\r\n        res.weight = 0; //todo уточнить\r\n        res.remainder = this.lot.weight - this.lot.weightSale;\r\n      } else if (this.lot.status.code === 'completed') {\r\n        res.weight = this.lot.weightSale;\r\n        res.remainder = this.lot.weight - this.lot.weightSale;\r\n      } else {\r\n        res.weight = this.lot.weightSale;\r\n      }\r\n\r\n      return res;\r\n    },\r\n  },\r\n  methods: {\r\n    prettify(str) {\r\n      try {\r\n        str = String(str);\r\n        return str.replace(/(\\d)(?=(\\d\\d\\d)+([^\\d]|$))/g, '$1 ');\r\n      } catch (e) {\r\n        console.error('Error in helpers prettify', e);\r\n      }\r\n    },\r\n    isSaleButtonClicked() {\r\n      return this.$store.state.lot.isSaleButtonClicked;\r\n    },\r\n    openLot: function () {\r\n      if (this.lot.status.code === 'new') {\r\n        this.$store.commit('lot/lotFormEdit', this.lot);\r\n      } else if (!this.isSaleButtonClicked()) {\r\n        this.$store.commit('lot/lotFormClose');\r\n        this.$store.commit('lot/setLot', this.lot);\r\n        this.$router.push('/arm_trading/lot/' + this.lot.id);\r\n      }\r\n    },\r\n  },\r\n  name: 'CalendarWeekLot',\r\n  components: { LotStatus, LotTradingTime, LotSaleButton, ShowMoreArrowIcon },\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}