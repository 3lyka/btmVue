{"ast":null,"code":"import { mapState, mapGetters } from 'vuex';\nimport LotDetailConfirmUmiop from '@/components/views/trading-session/lot/LotDetailConfirmUmiop';\nimport LotDetailSale from '@/components/views/trading-session/lot/LotDetailSale';\nimport LotDetailRegion from '@/components/views/trading-session/lot/LotDetailRegion';\nimport { prettify } from '@/utils/helpers/prettify';\nimport { useUserStore } from '@/stores/user';\nimport { mapState as mapStatePinia } from 'pinia';\nexport default {\n  name: 'LotDetail',\n  components: {\n    LotDetailRegion,\n    LotDetailSale,\n    LotDetailConfirmUmiop\n  },\n  computed: { ...mapState({\n      lot: state => state.lot.lot,\n      umiop: state => state.offer.umiop\n    }),\n    ...mapStatePinia(useUserStore, ['isTrader', 'isUmiop']),\n    ...mapGetters({\n      offerList: 'offer/offerListWithEdited'\n    }),\n\n    getCountContractor() {\n      let offersAgreed = this.offerList.filter(offer => offer.switchAccepted === true || offer.status.code === 'umiop_done').length;\n      const offersNoAgreed = this.offerList.length;\n\n      if (this.lot.status.code === 'receiving' || this.lot.status.code === 'waiting') {\n        offersAgreed = 0;\n      }\n\n      return offersAgreed + '/' + offersNoAgreed;\n    },\n\n    countWeightSale() {\n      const offersAgreed = this.offerList.filter(offer => offer.switchAccepted === true || offer.status.code === 'umiop_done');\n      return offersAgreed.reduce((total, offer) => total + offer.weightSale, 0);\n    },\n\n    getReceipt() {\n      const res = {};\n      res.title = 'Распределено';\n\n      if (this.lot.status.code === 'completed' || this.lot.status.code === 'cancelled') {\n        res.title = 'Продано';\n      }\n\n      if (this.lot.status.code === 'receiving' || this.lot.status.code === 'waiting') {\n        res.weight = 0; //todo уточнить\n      } else if (this.lot.status.code === 'cancelled') {\n        res.weight = 0; //todo уточнить\n      } else if (this.lot.status.code === 'completed') {\n        res.weight = this.countWeightSale;\n      } else {\n        res.weight = this.countWeightSale;\n      }\n\n      return res;\n    }\n\n  },\n  methods: {\n    prettify\n  }\n};","map":{"version":3,"mappings":"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","names":["mapState","mapGetters","LotDetailConfirmUmiop","LotDetailSale","LotDetailRegion","prettify","useUserStore","mapStatePinia","name","components","computed","lot","state","umiop","offer","offerList","getCountContractor","offersAgreed","filter","switchAccepted","status","code","length","offersNoAgreed","countWeightSale","reduce","total","weightSale","getReceipt","res","title","weight","methods"],"sourceRoot":"","sources":["C:\\openserver\\domains\\U190001472_BitumMap_Vue\\src\\components\\views\\trading-session\\lot\\LotDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"lot-detail\">\r\n    <div class=\"lot-detail__box\">\r\n      <div class=\"lot-detail__title\">\r\n        <div class=\"lot-detail__title-wrapper\">\r\n          <p class=\"lot-detail__title-id\">№{{ prettify(lot.id) }}</p>\r\n          <img class=\"lot-detail__title-img\" src=\"@/assets/img/oil.svg\" />\r\n        </div>\r\n        <div class=\"lot-detail__title-shipment\">\r\n          <div class=\"lot-detail__title-shipment-text\">Отгрузка</div>\r\n          <div v-if=\"lot.shippingDate\" class=\"lot-detail__title-shipment-date\">\r\n            {{ lot.shippingDate }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"lot-detail__description\">\r\n        <div v-if=\"lot.factory.name\" class=\"lot-detail__description-name\">\r\n          {{ lot.factory.name }}\r\n        </div>\r\n        <div v-if=\"lot.product.name\" class=\"lot-detail__description-mark\">\r\n          {{ lot.product.name }}\r\n        </div>\r\n        <div class=\"lot-detail__description-create\">Выставлено</div>\r\n        <div v-if=\"lot.weight\" class=\"lot-detail__description-count-weight\">\r\n          {{ prettify(lot.weight) }} т\r\n        </div>\r\n        <div class=\"lot-detail__description-box\">\r\n          <div class=\"lot-detail__description-receipt\">\r\n            <div class=\"lot-detail__description-receipt-title\">\r\n              {{ getReceipt.title }}\r\n            </div>\r\n            <div class=\"lot-detail__description-receipt-count-weight\">\r\n              {{ prettify(getReceipt.weight) }} т\r\n            </div>\r\n          </div>\r\n          <div class=\"lot-detail__description-receipt\">\r\n            <div class=\"lot-detail__description-receipt-title\">Предложений</div>\r\n            <div class=\"lot-detail__description-receipt-count\">\r\n              {{ getCountContractor }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <LotDetailSale\r\n        :status=\"lot.status\"\r\n        :resoldInLot=\"lot.resoldInLot\"\r\n        :countWeightSale=\"countWeightSale\"\r\n      />\r\n      <div class=\"lot-detail__info\">\r\n        <div class=\"lot-detail__info-title\">Цена по прейскуранту</div>\r\n        <div class=\"lot-detail__info-region\">\r\n          <!-- {{lot.factory.shortName}} -->\r\n          <span class=\"lot-detail__info-region-price\">{{\r\n            lot.priceMin ? prettify(lot.priceMin) + ' ₽' : ''\r\n          }}</span>\r\n        </div>\r\n        <LotDetailConfirmUmiop\r\n          v-if=\"isTrader\"\r\n          v-show=\"umiop.showUmiop\"\r\n          :offerList=\"offerList\"\r\n          :umiop=\"umiop\"\r\n          :lot=\"lot\"\r\n        />\r\n        <LotDetailRegion :regions=\"lot.regions\" />\r\n        <div v-if=\"lot.comment\">\r\n          <div class=\"lot-detail__info-comment\">Комментарий</div>\r\n          <div class=\"lot-detail__info-comment-text\">{{ lot.comment }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters } from 'vuex';\r\nimport LotDetailConfirmUmiop from '@/components/views/trading-session/lot/LotDetailConfirmUmiop';\r\nimport LotDetailSale from '@/components/views/trading-session/lot/LotDetailSale';\r\nimport LotDetailRegion from '@/components/views/trading-session/lot/LotDetailRegion';\r\nimport { prettify } from '@/utils/helpers/prettify';\r\nimport { useUserStore } from '@/stores/user';\r\nimport { mapState as mapStatePinia } from 'pinia';\r\n\r\nexport default {\r\n  name: 'LotDetail',\r\n  components: { LotDetailRegion, LotDetailSale, LotDetailConfirmUmiop },\r\n  computed: {\r\n    ...mapState({\r\n      lot: (state) => state.lot.lot,\r\n      umiop: (state) => state.offer.umiop,\r\n    }),\r\n    ...mapStatePinia(useUserStore, ['isTrader', 'isUmiop']),\r\n    ...mapGetters({\r\n      offerList: 'offer/offerListWithEdited',\r\n    }),\r\n    getCountContractor() {\r\n      let offersAgreed = this.offerList.filter(\r\n        (offer) =>\r\n          offer.switchAccepted === true || offer.status.code === 'umiop_done'\r\n      ).length;\r\n      const offersNoAgreed = this.offerList.length;\r\n\r\n      if (\r\n        this.lot.status.code === 'receiving' ||\r\n        this.lot.status.code === 'waiting'\r\n      ) {\r\n        offersAgreed = 0;\r\n      }\r\n\r\n      return offersAgreed + '/' + offersNoAgreed;\r\n    },\r\n    countWeightSale() {\r\n      const offersAgreed = this.offerList.filter(\r\n        (offer) =>\r\n          offer.switchAccepted === true || offer.status.code === 'umiop_done'\r\n      );\r\n      return offersAgreed.reduce((total, offer) => total + offer.weightSale, 0);\r\n    },\r\n    getReceipt() {\r\n      const res = {};\r\n      res.title = 'Распределено';\r\n      if (\r\n        this.lot.status.code === 'completed' ||\r\n        this.lot.status.code === 'cancelled'\r\n      ) {\r\n        res.title = 'Продано';\r\n      }\r\n\r\n      if (\r\n        this.lot.status.code === 'receiving' ||\r\n        this.lot.status.code === 'waiting'\r\n      ) {\r\n        res.weight = 0; //todo уточнить\r\n      } else if (this.lot.status.code === 'cancelled') {\r\n        res.weight = 0; //todo уточнить\r\n      } else if (this.lot.status.code === 'completed') {\r\n        res.weight = this.countWeightSale;\r\n      } else {\r\n        res.weight = this.countWeightSale;\r\n      }\r\n\r\n      return res;\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    prettify,\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}